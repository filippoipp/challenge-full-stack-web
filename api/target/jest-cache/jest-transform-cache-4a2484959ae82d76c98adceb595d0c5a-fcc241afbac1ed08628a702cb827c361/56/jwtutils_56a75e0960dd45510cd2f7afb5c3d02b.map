{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AAAA;AAAA;;AAEA,SAAgBA,aAAhB,GAA6B;EAAA;EAAA;EAC3B,MAAMC,UAAU;EAAA;EAAA,0BAAG;IACjBC,GAAG,EAAEC,EAAE,CAACC,YAAH,CAAgBC,IAAI,CAACC,IAAL,CAAUC,SAAV,EAAqB,mBAArB,CAAhB,CADY;IAEjBC,UAAU,EAAEC,OAAO,CAACC,GAAR,CAAYC;EAFP,CAAH,CAAhB;EAKA,MAAMC,aAAa;EAAA;EAAA,0BAAgB;IACjCC,SAAS,EAAE,OADsB;IAEjCC,SAAS,EAAE;EAFsB,CAAhB,CAAnB;;EAN2B;EAAA;EAW3B,OAAO,yBAAK,EAAL,EAASb,UAAT,EAAqBW,aAArB,CAAP;AACD;;;;AAZDG;;AAqBA,SAAgBC,aAAhB,CAA8BC,KAA9B,EAA2C;EAAA;EAAA;EACzC,MAAMC,SAAS;EAAA;EAAA,0BAAGf,EAAE,CAACC,YAAH,CAAgBC,IAAI,CAACC,IAAL,CAAUC,SAAV,EAAqB,kBAArB,CAAhB,CAAH,CAAf;EAEA,MAAMY,aAAa;EAAA;EAAA,0BAAkB;IACnCC,UAAU,EAAE,CAAC,OAAD;EADuB,CAAlB,CAAnB;;EAHyC;EAAA;EAOzC,OAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAoB;IAAA;IAAA;IAAA;IACrC,2BAAON,KAAP,EAAcC,SAAd,EAAyBC,aAAzB,EAAwC,CAACK,KAAD,EAAQC,OAAR,KAAiC;MAAA;MAAA;MAAA;;MACvE,IAAID,KAAJ,EAAW;QAAA;QAAA;QAAA;QAAA,OAAOD,MAAM,CAACC,KAAD,CAAb;MAAqB,CAAhC;MAAA;MAAA;QAAA;MAAA;;MADuE;MAGvEF,OAAO,CAACG,OAAD,CAAP;IACD,CAJD;EAKD,CANM,CAAP;AAOD;;;;AAdDV","names":["generateToken","privateKey","key","fs","readFileSync","path","join","__dirname","passphrase","process","env","AUTH_PASSPHRASE","signInOptions","algorithm","expiresIn","exports","validateToken","token","publicKey","verifyOptions","algorithms","Promise","resolve","reject","error","decoded"],"sources":["/home/filippoippolitorodrigues/√Årea de Trabalho/MYPROJECTS/challenge-full-stack-web/api/src/utils/jwt.utils.ts"],"sourcesContent":["import {\n  sign, SignOptions, verify, VerifyOptions,\n} from 'jsonwebtoken';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nexport function generateToken() {\n  const privateKey = {\n    key: fs.readFileSync(path.join(__dirname, '../../private.pem')),\n    passphrase: process.env.AUTH_PASSPHRASE,\n  };\n\n  const signInOptions: SignOptions = {\n    algorithm: 'RS256',\n    expiresIn: '24h',\n  };\n\n  return sign({}, privateKey, signInOptions);\n}\n\ninterface TokenPayload {\n  exp: number;\n  accessTypes: string[];\n  name: string;\n  userId: number;\n}\n\nexport function validateToken(token: string): Promise<TokenPayload> {\n  const publicKey = fs.readFileSync(path.join(__dirname, '../../public.pem'));\n\n  const verifyOptions: VerifyOptions = {\n    algorithms: ['RS256'],\n  };\n\n  return new Promise((resolve, reject) => {\n    verify(token, publicKey, verifyOptions, (error, decoded: TokenPayload) => {\n      if (error) return reject(error);\n\n      resolve(decoded);\n    });\n  });\n}\n"]}